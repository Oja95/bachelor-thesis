\documentclass[..thesis.tex]{subfiles}

\begin{document}

\subsection{Sample code}

\label{A:sample-code}
\begin{lstlisting}[language=C,style=def]
#include <linux/kernel.h>
// Sample code
\end{lstlisting}

\newpage
\end{document}
